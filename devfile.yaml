schemaVersion: 2.2.0
metadata:
  name: amazon-q-coffee-shop-api
  version: 1.0.0
  displayName: Amazon Q Coffee Shop API
  description: Coffee Shop API with H2 Database and Liquibase support
  tags:
    - Java
    - Micronaut
    - H2
    - Liquibase
  projectType: Java
  language: Java

components:
  - name: tools
    container:
      image: eclipse-temurin:17-jdk
      memoryLimit: 2Gi
      mountSources: true
      command: ['sleep', 'infinity']
      env:
        - name: JAVA_HOME
          value: /opt/java/openjdk
        - name: MAVEN_OPTS
          value: "-Xmx1024m"

commands:
  - id: build
    exec:
      component: tools
      commandLine: './mvnw clean package'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: build
        isDefault: true

  - id: run
    exec:
      component: tools
      commandLine: './mvnw mn:run'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: run
        isDefault: true

  - id: test
    exec:
      component: tools
      commandLine: './mvnw test'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: test
        isDefault: true

  - id: debug
    exec:
      component: tools
      commandLine: './mvnw mn:run -Dmn.debug'
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: debug
        isDefault: true