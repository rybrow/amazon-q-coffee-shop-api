schemaVersion: 2.2.0
metadata:
  name: amazon-q-coffee-shop-api
  version: 1.0.0
  displayName: Coffee Shop API
  description: Coffee Shop API with H2 Database and Liquibase support
  tags:
    - Java
    - Maven
    - Micronaut
    - H2
    - Liquibase

components:
  - name: java-tools
    container:
      image: eclipse-temurin:21-jdk
      memoryLimit: 2Gi
      mountSources: true
      env:
        - name: JAVA_HOME
          value: /opt/java/openjdk
        - name: MAVEN_OPTS
          value: "-XX:MaxRAMPercentage=75.0"

commands:
  - id: build
    exec:
      component: java-tools
      commandLine: ./mvnw clean package
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: build
        isDefault: true

  - id: run
    exec:
      component: java-tools
      commandLine: ./mvnw mn:run
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: run
        isDefault: true

  - id: test
    exec:
      component: java-tools
      commandLine: ./mvnw test
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: test
        isDefault: true

  - id: debug
    exec:
      component: java-tools
      commandLine: ./mvnw mn:run -Dmn.debug
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: debug
        isDefault: true